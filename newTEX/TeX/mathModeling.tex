\section{Математическое моделирование системы}

\subsection{Вывод зависимости линейного изменения пьезоэлемента и углового перемещения ротора двигателя}
Рассмотрим схему на рисунке \ref{sh_piezo} выбранного пьезодвигателя со всеми необходимыми обозначениями, котрая описывает шаг пьезодвигателя.

\begin{figure}[ht!]
	\centering
	\includegraphics[width = 0.8\textwidth]{images/sh_piezo} 
	\caption{Cхема пьезодвигателя: 1 - пьезоэлемент, 2 - ротор, 3 - усиливающая пьезоэлемент конструкция, 4 - инерционный механизм, 5 - корпус двигателя}
	\label{sh_piezo}
\end{figure}

При подаче сигнала, длина пьезоэлемента (1) начинает меняться. Усиливающая изменения длины пьезоэлемента конструкция (3) воздействует на корпус двигателя (5), тем самым поворачивая ротор (2) на определенный угол $\alpha$. Когда длина пьезоэлемента начинает опять меняться инерционный механизм (4) будет контролировать, чтобы ротор не вернулся в первоначальное положение, тем самым после каждого изменения длины пьезоэлемента ротор будет поворачиваться на определенный угол, "шагать". 
Также пьезодвигатель таким способом может поворачиваться на полный угол.

Рассмотрим изменение длины пьезоэлемента. Из технической характеристики описанной в приложении \ref{app:F} следует, что шаг двигателя равен 0.2 мрад, также длина радиуса r равна 5 мм.

Из рисунка \ref{pic:sh_work} видно, что для поворота ротора на угол $\alpha$ нужно переместиться на длину дуги L. Так как угол шага очень мал, будем рассматривать сектор ABC как треугольник.

\begin{figure}[ht!]
	\centering
	\includegraphics[width = 0.8\textwidth]{images/sh_work} 
	\caption{Схема устройства}
	\label{pic:sh_work}
\end{figure}

Тогда справедливы следующие уравнения: 
\begin{gather*}
	L = r * sin\alpha\\
	sin \alpha \approx \alpha\\
	L = r * \alpha\\
	L = 0.005 * 0.002 = 0.00001
\end{gather*} 

В системе представленной на рисунке \ref{sh_piezo} L - это линейное перемещение конструкции (2). Составим уравнение, показывающее зависимость изменения длины пьезоэлемента и поворота ротора на определенный угол.
\begin{gather}
	L = K_{усил} * x
	\label{eq:l=kx}
\end{gather}	
\begin{ESKDexplanation}
	\item где $x$ - перемещение;
	\item $K_{усил}$ - коэффициент усиления конструкции
\end{ESKDexplanation}

Из характеристик пьезоэлемента $K_{усил} = 2$. Тогда уравнение \ref{eq:l=kx} принимает вид:
\begin{gather*}
	L=2*x
	\label{eq:l=2x}
\end{gather*}


\subsection{Математическая модель пьезодвигателя}

Будем рассматривать исполнительное пьезоэлектрическое устройство как упругую механическую систему с одной степенью свободы.
В этом случае математическая модель может быть получена на основе уравнения баланса сил в пьезоактуаторе:
\begin{equation}\label{eq:main}
	F_y = F_O + F_Д + F_d + F_B
\end{equation}

\begin{ESKDexplanation}
	\item где $F_y = C_px$ - усилие упругой деформации ПД;
	\item $F_O = K_OU_p$ - усилие, вызванное обратным пьезоэффектом;
	\item $F_Д = -m\frac{d^2x}{dt^2}$ - динамическое усилие в ПД;
	\item $F_d = -K_d\frac{dx}{dt}$ - демпфирующее усилие, обусловленное механическими потерями;
	\item $F_B$ - внешнее воздействие.
\end{ESKDexplanation}

Из баланса сил в пьезодвигателе следует:
\begin{align}
m\ddot{x} + K_d\dot{x} + C_px = K_0U_p + F_B
\label{eq:diff}
\end{align}
\begin{ESKDexplanation}		
	\item $C_p$ - коэффициент упругости;
	\item $K_O$ - коэффициент обратного пьезоэффекта;
	\item $U_p$ - напряжение на электродах ПД; 
	\item $m$ - масса перемещаемой нагрузки;
	\item $K_d$ - коэффициент демпфирования.
\end{ESKDexplanation}

Из уравнения \ref{eq:diff}, при нулевом внешнем воздействии можно составить передаточную функцию для пьезодвигателя:

\begin{align} 
W_{pz}(s) =\frac{K_0}{ms^2 + K_ds + C_p}.
\label{Wpz}
\end{align}\par
Управление ПД осуществляется с усиленного сигнала микроконтроллера, при этом сам ПД является емкостной нагрузкой. В этом случае данный сигнал описывается апериодическим звеном первого порядка:
\begin{align}
W_{v}(s) = \frac{K_u}{T_us + 1},
\end{align}
\begin{ESKDexplanation}		
	\item где $K_u=\frac{U_{pm}}{U_m}$ - коэффициент усиления;
	\item $U_{pm}$ - максимальное напряжение ПД;
	\item $U_m$ - максимальное напряжение управления;
	\item $T_u=RC$ - Постоянная времени ВВУ; 
	\item $R$ - Выходное сопротивление ВВУ;
	\item $C$ - емкость ПД.
\end{ESKDexplanation}
\par
Так как $W_{pz}$ и $W_v$ соединены последовательно, получаем итоговую передаточную функцию:
\begin{align}
W_{pz}(s) = \frac{K_0\cdot K_u}{(T_us + 1)(ms^2 + K_ds + C_p)}.
\label{equ:per}
\end{align}

Из уравнения \ref{eq:diff} можно представить структурную схему пьезодвигателя изображенную на рисунке \ref{struct_schem}), выходным параметром которой является изменения длины пьезоэлемента.
В приложении \ref{app:I} представлен Листинг программы, описывающей параметры системы.

\begin{figure}[ht!]
	\centering
	\includegraphics[width = 0.8\textwidth]{images/struct_schem} 
	\caption{Структурная схема пьезодвигателя}
	\label{struct_schem}
\end{figure}




